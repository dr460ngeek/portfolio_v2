<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pratham's Blog</title>
    <meta name="description" content="Blog by Pratham, a BCA student and aspiring developer">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="styles/styles_blog.css">
</head>

<body>
    <header>
        <nav>
            <div class="nav-container">
                <a href="index.html" class="logo-container">
                    <!-- ADD YOUR LOGO IMAGE PATH HERE -->
                    <img class="nav-logo" src="https://raw.githubusercontent.com/dr460ngeek/portfolio_v2/refs/heads/main/images/logo.png" alt="Pratham's Logo"
                        onerror="this.style.display='none'">
                    <h1>Pratham's <span>Blog.</span></h1>
                </a>
                <ul class="nav-tabs">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#about">About</a></li>
                    <!-- <li><a href="index.html#gallery-section">Gallery</a></li> -->
                    <li><a href="./blog.html" class="active">Blog</a></li>
                    <!-- <li><a href="index.html#projects">Projects</a></li> -->
                    <li><a href="index.html#contact">Contact</a></li>
                </ul>
                <div class="hamburger">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <!-- Blog Listing View -->
        <section id="blog-listing">
            <div class="blog-header">
                <h1>My Blog</h1>
                <p>Thoughts, tutorials, and insights on technology, programming, and my learning journey</p>
            </div>
            
            <!-- Search Bar -->
            <div class="search-container">
                <div class="search-box">
                    <input type="text" class="search-input" id="searchInput" placeholder="Search blog posts...">
                    <button class="search-button" id="searchButton">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>

            <div id="searchResultsInfo" class="search-results-info" style="display: none;">
                Showing results for: <span id="searchQuery"></span>
            </div>

            <div class="blog-grid" id="blog-posts-container">

            <div class="blog-grid" id="blog-posts-container">
                <!-- Blog posts will be loaded here dynamically -->
                <div class="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>

        <!-- Blog Post Detail View (Initially Hidden) -->
        <section id="blog-detail" style="display: none;">
            <a href="./blog.html" class="back-to-blog"><i class="fas fa-arrow-left"></i> Back to Blog</a>

            <article class="blog-post">
                <div class="post-header">
                    <h1 id="post-title">Loading Post...</h1>
                    <div class="post-meta" id="post-meta">
                        <span><i class="far fa-calendar"></i> <span id="post-date">Loading...</span></span>
                        <span><i class="far fa-clock"></i> <span id="post-read-time">Loading...</span></span>
                        <span><i class="far fa-user"></i> Pratham</span>
                    </div>
                    <div class="post-tags" id="post-tags">
                        <!-- Tags will be loaded here -->
                    </div>
                </div>

                <div class="markdown-content" id="post-content">
                    <div class="loading">
                        <div class="spinner"></div>
                    </div>
                </div>
            </article>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <!-- <div class="footer-links">
                <a href="index.html">Home</a>
                <a href="index.html#about">About</a>
                <a href="index.html#gallery-section">Gallery</a>
                <a href="index.html#projects">Projects</a>
                <a href="index.html#contact">Contact</a>
                <a href="blog.html">Blog</a>
            </div> -->
            <p class="copyright">&copy; 2025 dr460n. All rights reserved.</p>
        </div>
    </footer>

    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <button class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>
        // Configure marked to use highlight.js for code blocks
        marked.setOptions({
            highlight: function (code, lang) {
                if (lang && hljs.getLanguage(lang)) {
                    return hljs.highlight(code, { language: lang }).value;
                }
                return hljs.highlightAuto(code).value;
            }
        });

        // Mobile Navigation
        const hamburger = document.querySelector('.hamburger');
        const navLinks = document.querySelector('.nav-tabs');

        hamburger.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            hamburger.innerHTML = navLinks.classList.contains('active') ?
                '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
        });

        // Dark mode toggle
        const darkModeToggle = document.getElementById('darkModeToggle');

        darkModeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');

            if (document.body.classList.contains('dark-mode')) {
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                localStorage.setItem('darkMode', 'enabled');
            } else {
                darkModeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                localStorage.setItem('darkMode', 'disabled');
            }
        });

        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
            darkModeToggle.innerHTML = '<i class="fas fa-sun"></i>';
        }

        // Back to top button
        const backToTopBtn = document.getElementById('backToTop');

        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        });

        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Function to get all markdown files from the markdown folder
        async function getMarkdownFiles() {
            try {
                // In a real implementation, you would fetch this from a server API
                // For this example, we'll use a predefined list
                const response = await fetch('markdown/file-list.json');
                if (!response.ok) {
                    throw new Error('File list not found');
                }
                return await response.json();
            } catch (error) {
                console.error('Error loading markdown file list:', error);

                // Fallback to a default list if the file-list.json doesn't exist
                return [
                        {
                            "id": "Vim/Neovim Basics",
                            "title": "Vim/Neovim Basics: A Beginner's Guide to Efficient Text Editing",
                            "date": "Sep 16, 2025",
                            "readTime": "5 min read",
                            "tags": ["Vim", "Neovim", "Text Editing", "Efficiency"],
                            "image": "https://raw.githubusercontent.com/dr460ngeek/portfolio_v2/refs/heads/main/images/nvim-vim.png",
                            "markdownFile": "markdown/VIM-cheatsheet.md"
                        },
                        {
                            "id": "linux-commands",
                            "title": "Linux Command Line Cheat Sheet: Essential Commands for Everyday Use",
                            "date": "Sep 16, 2025",
                            "readTime": "7 min read",
                            "tags": ["Linux", "Terminal", "Productivity"],
                            "image": "https://raw.githubusercontent.com/dr460ngeek/portfolio_v2/refs/heads/main/images/linux.jpeg",
                            "markdownFile": "markdown/Linux-cheatsheet.md"
                        },
                        {
                            "id": "git-mastery",
                            "title": "Git Cheat Sheet: Mastering Version Control",
                            "date": "Sep 16, 2025",
                            "readTime": "7 min read",
                            "tags": ["Git", "D-VCS", "Version Control", "Project Management"],
                            "image": "https://raw.githubusercontent.com/dr460ngeek/portfolio_v2/refs/heads/main/images/git.png",
                            "markdownFile": "markdown/Git-cheatsheet.md"
                        }
                ];
            }
        }

        // Function to load and display blog posts
        async function loadBlogPosts() {
            const container = document.getElementById('blog-posts-container');

            // Show loading indicator
            container.innerHTML = '<div class="loading"><div class="spinner"></div></div>';

            try {
                const blogPosts = await getMarkdownFiles();

                // Clear loading indicator
                container.innerHTML = '';

                // Create blog post cards
                blogPosts.forEach(post => {
                    const blogCard = document.createElement('article');
                    blogCard.className = 'blog-card';
                    blogCard.innerHTML = `
                        <div class="blog-image">
                            <img src="${post.image}" alt="${post.title}" onerror="this.src='https://images.unsplash.com/photo-1555066931-4365d14bab8c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80'">
                        </div>
                        <div class="blog-content">
                            <h2>${post.title}</h2>
                            <div class="blog-meta">
                                <span><i class="far fa-calendar"></i> ${post.date}</span>
                                <span><i class="far fa-clock"></i> ${post.readTime}</span>
                            </div>
                            <p>${getPostExcerpt(post.id)}</p>
                            <div class="blog-tags">
                                ${post.tags.map(tag => `<span class="blog-tag">${tag}</span>`).join('')}
                            </div>
                            <a href="#${post.id}" class="read-more">Read More <i class="fas fa-arrow-right"></i></a>
                        </div>
                    `;

                    // Add click event to load the full post
                    blogCard.querySelector('.read-more').addEventListener('click', (e) => {
                        e.preventDefault();
                        window.location.hash = post.id;
                        loadBlogPost(post);
                    });

                    container.appendChild(blogCard);
                });
            } catch (error) {
                console.error('Error loading blog posts:', error);
                container.innerHTML = '<p>Error loading blog posts. Please check your markdown folder.</p>';
            }
        }

        // Function to get post excerpt (in a real app, this would come from the markdown file)
        function getPostExcerpt(postId) {
            const excerpts = {
                "c-programming": "Learn the fundamentals of C programming language, from basic syntax to memory management. Perfect for beginners starting their programming journey.",
                "linux-commands": "Discover the most useful Linux commands that every developer should know to improve productivity and efficiency in their workflow.",
                "git-mastery": "A comprehensive guide to version control with Git and how to effectively use GitHub for collaboration and project management."
            };

            return excerpts[postId] || "Read this informative blog post about technology and programming.";
        }

        // Function to load a specific blog post
        async function loadBlogPost(post) {
            // Show loading state
            document.getElementById('blog-listing').style.display = 'none';
            document.getElementById('blog-detail').style.display = 'block';
            document.getElementById('post-title').textContent = post.title;
            document.getElementById('post-date').textContent = post.date;
            document.getElementById('post-read-time').textContent = post.readTime;

            // Update tags
            const tagsContainer = document.getElementById('post-tags');
            tagsContainer.innerHTML = post.tags.map(tag =>
                `<span class="blog-tag">${tag}</span>`
            ).join('');

            // Fetch and render markdown content
            try {
                const response = await fetch(post.markdownFile);
                if (!response.ok) {
                    throw new Error('Markdown file not found');
                }

                const markdown = await response.text();
                document.getElementById('post-content').innerHTML = marked.parse(markdown);

                // Highlight code blocks
                document.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
            } catch (error) {
                console.error('Error loading markdown:', error);
                document.getElementById('post-content').innerHTML = `
                    <p>Sorry, there was an error loading this blog post.</p>
                    <p>Please make sure the file <strong>${post.markdownFile}</strong> exists in your markdown folder.</p>
                    <p>Error details: ${error.message}</p>
                `;
            }
        }

        // Handle page load and hash changes
        document.addEventListener('DOMContentLoaded', async function () {
            // Load blog posts
            await loadBlogPosts();

            // Check if we're viewing a specific blog post
            const hash = window.location.hash.substring(1);

            if (hash) {
                try {
                    const blogPosts = await getMarkdownFiles();
                    const post = blogPosts.find(p => p.id === hash);
                    if (post) {
                        loadBlogPost(post);
                    }
                } catch (error) {
                    console.error('Error loading blog post:', error);
                }
            }

            // Add click event listeners to blog cards (delegation)
            document.getElementById('blog-posts-container').addEventListener('click', function (e) {
                if (e.target.closest('.read-more')) {
                    e.preventDefault();
                    const link = e.target.closest('.read-more');
                    const postId = link.getAttribute('href').substring(1);
                    window.location.hash = postId;

                    // Find the post and load it
                    getMarkdownFiles().then(blogPosts => {
                        const post = blogPosts.find(p => p.id === postId);
                        if (post) {
                            loadBlogPost(post);
                        }
                    });
                }
            });
        });
        
        // Search functionality
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');
            const searchResultsInfo = document.getElementById('searchResultsInfo');
            const searchQueryElement = document.getElementById('searchQuery');
            
            // Function to perform search
            function performSearch() {
                const query = searchInput.value.trim().toLowerCase();
                
                if (query === '') {
                    // If search is empty, show all posts
                    searchResultsInfo.style.display = 'none';
                    loadBlogPosts(allPosts);
                    return;
                }
                
                // Filter posts based on search query
                const filteredPosts = allPosts.filter(post => {
                    // Search in title
                    if (post.title.toLowerCase().includes(query)) return true;
                    
                    // Search in tags
                    if (post.tags.some(tag => tag.toLowerCase().includes(query))) return true;
                    
                    // Search in content
                    if (post.content.toLowerCase().includes(query)) return true;
                    
                    return false;
                });
                
                // Show search results info
                searchResultsInfo.style.display = 'block';
                searchQueryElement.textContent = `"${query}"`;
                
                // Display filtered posts
                loadBlogPosts(filteredPosts);
            }
            
            // Event listeners for search
            searchButton.addEventListener('click', performSearch);
            searchInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
        }

        // Handle page load and hash changes
        document.addEventListener('DOMContentLoaded', async function() {
            // Load blog posts
            loadBlogPosts();
            
            // Setup search functionality
            setupSearch();
            
            // Check if we're viewing a specific blog post
            const hash = window.location.hash.substring(1);
            
            if (hash) {
                const post = allPosts.find(p => p.id === hash);
                if (post) {
                    loadBlogPost(post);
                }
            }
        });

        // Handle browser back button
        window.addEventListener('hashchange', async function() {
            const hash = window.location.hash.substring(1);
            
            if (hash) {
                const post = allPosts.find(p => p.id === hash);
                if (post) {
                    loadBlogPost(post);
                }
            } else {
                // Switch back to blog listing
                document.getElementById('blog-detail').style.display = 'none';
                document.getElementById('blog-listing').style.display = 'block';
                document.title = "Pratham's Blog";
            }
        });
    </script>
</body>

</html>